\documentclass[]{book}

\input{header.tex}

%opening
\title{High dimensional portfolios - estimation and uncertainty}
\author{Erik Thors√©n}

\begin{document}

\maketitle

\section*{Acknowledgements}

\newpage
\section*{List of papers}

\tableofcontents
%%%%%% ------------------------------------------------------------------------
\chapter[Introduction]{Introduction - making decisions and allocations}\label{ch:intro}
%%%%%% ------------------------------------------------------------------------
% General introduction to why portfolio theory and allocations are hard
% ca 2pages
There are a number of different saying that describe how you should make an important decision. The first that comes to mind\footnote{Its rather the first that came up in the google search "sayings relating to big decisions".} is "never make a decision on an empty stomach" or "sleep on it". 
While the former is preemptive and its solution is to keep a healthy diet the former is reactive and stresses you to never make a hasty decision. You should always wait for a while. Deciding what to do with your money or wealth is of course one of these decision. Should you buy a house, a car, save in stocks or simply place everything under the madress and sleep on an uneven surface for the rest of your life? This thesis will not help you with your madress nor will it directly tell you which of these options to pick. However, it does contain some interesting papers on how to allocate your money between a few (or inifinitely many) options!

%%%%%%%%%%%%%%%
% Give some simple example which we extend and work with.
%%%%%%%%%%%%%%%
\colr{
Making sound investments is paramount to portfolio theory. The portfolio is simply a collection of your investments in different assets.
Making optimal allocations is paramount to portfolio theory. 
The term 'optimal' usually refers to the fact that you should not make an investment that does not return any profit and take more risk than necessary. 

Imagine that you are going to invest in a house and borrow the money you need to buy it. 
You have come to an agreement with a bank that you will loan a certain amount and pay interest rate on it. 
The interest is paid on a monthly basis. 
You are very sure that one of the houses that you are looking at will be worth twice the money in two years. 
The decision is simple, if the cost, e.g. the total amount of interest you pay on your loan, is less than the profit you will make selling the house after two years then you should buy the house! 
However, how certain are you that you will be able to sell it at \textit{twice the price in two years}? 
You can not be absolutely certain. 
The housing market might collapse and you will be left with a house that has no worth and no one wants to buy. There is some risk in this decision. 
Lets assume that you are fairly certain that the house will be worth more than twice the money in two years. 
When should we decide to invest in this example? 
It is not as clear as before since we dont know what the house will be worth until we sell it.
The future is always uncertain.

In reality, you dont have a single asset to invest in. 
You most often have many. 
The house is most likely one of many options you can spend your money on. 
You might have a house, kids which you hope will become famous for their skills in sports or stocks. 
Maintaining any of the houses may be costly though it may increase drastically by the investment. 
Driving your kids to practise does not take much investment but it may be highly uncertainty that they will even like it in ten years. 
How should you spend your money on these?
To add to the complexity they might increase (or decrease) in value depending on how you maintain or do not maintain them.
The example is of course valid for any type of \textit{asset} such as stocks, bonds or in essence any type of financial contract. 
Properties might just require more maintainance than a stock.
%Sometimes its worth having everything in a house or another type of \textit{asset} (such as stocks)
The natural question is now, given your collection or \textit{portfolio} of properties, how should you allocate your money when you dont know what the future holds? 
If you think that the market for properties is going to be more profitable than the interest rate you pay for your loans then it makes sense to spread your investment across all properties. 
If the summer house suffers from a mold infection you are most likely fine, your portfolio will not be worthless because you spent money on something that went ..........

 have \textit{diversified} your investment.
Try to do some maintainance on all of your houses in order to spread the \textit{risk} of investing everything in one of them. 
If you do not know what the future holds and . It might even be that some of your other investment is more profitable than you expected and will cover for your loss. In the end you want to minimize the risk or the possibility to loose all your money by diversifying portfolio allocations!

Now comes the issue at hand. 
What happens if you dont know what your assets will be worth in the future?
The first approach could be to specify probabilities for all possible scenarios you think can happen as we did in the example above.
This becomes very unpractical, very quickly. 
The second, more practical approach is to gather information on how your assets have developed in order to get a better estimate of its future values.
This train of thought is the main topic of this thesis. 
We want to construct portfolios which adhere to some criterias while knowing that the future is uncertain and to be honest, we know very little of how our assets will develop in the future. We use data to estimate what we think of the future!

If the dont know what our assets might bring in the future a natural model for it is to assume that they are stochastic. \textbf{Give an example to why portfolios are better than holding a single asset?}
}
%%%%%% ------------------------------------------------------------------------
\chapter{Modern Portfolio Theory}
%%%%%% ------------------------------------------------------------------------
Modern Portfolio Theory was introduced by \cite{markowitz1959portfolio}. 
In his seminal work he argued that any portfolio which simply maximize its profit will result in a naive solution.
Very much like the example in Chapter \ref{ch:intro}. 
The future is unknown and (one of) the best model(s) we have for it is stochastic
Investing all your capital in the asset with the highest return is not sensible if you do not know the future.
Such an investment will cause you to take an extreme amount of risk. 
He therefore argued that any well diversified portfolio should be prefered to any non diversified portfolio. 
Such a portfolio can be obtained through many different procedures but he proposed the use of the first two moments for the allocation problem.
If an asset has high return on average, then that should be accounted for though not at the cost of large amounts of risk. If an asset implies a lot of risk, then we should try to invest small amounts in it.

To state his portfolio allocation problem we first introduce the relevant quantities. In this thesis we never use the asset prices themselves but their a transformation of the relative differences, that is, their simple returns. The simple return is defined as $r_{i,t} := (y_{i,t}-y_{i,t-1})/y_{i,t-1}$ and the log return is then defined as
$
x_{i,t} := \log(r_{i,t} + 1)
$
where $y_{i,t}$ is the price of the $i$th asset at time $t$. We model a portfolio with $p$ assets as $\sum_{i=1}^p w_i x_{i,t} = \bw^\top \bx_t$ where $\bw=(w_1, ..., w_p)$ are the portfolio weights and $\bx_t=(x_{1,t},x_{2,t},..., x_{p,t})$ are the log returns. Notice that this is an approximation. In reality we would want to work with $\sum_{i=1}^p w_i r_{i,t}$ since it is additive in the number of assets. However, logarithmic returns are additive in time which can be desirable. Compounding returns results in simple addition. The difference between the two approaches is very small if the returns are small, which is often true for financial assets. The models we work with in this thesis often rely on the log returns and not the returns. We will omit the time index $t$ to keep the notation tidy unless otherwise stated. 

We assume assets $\bx$ are random with mean $\optn{E}(\bx)=\bmu$ and covariance matrix $\optn{Var}(\bx)=\bSigma$. Although there is usually little restriction on $\bmu$ there is usually very specific restrictions on the covariance matrix $\bSigma$. Since the covariance matrix is a subject of its own we dedicate the next section to it and disregards these restrictions for now. We will merely say that it is well behaved. The restrictions on the mean will be commented on below. Using the two moments for the asset returns the portfolio distribution $x = \bw^\top \bx$ has mean $\optn{E}(x)=\bw^\top \bmu$ and variance $\optn{Var}(x)=\bw^\top \bSigma \bw$. Let $\mu_0$ be the target return that the investor would like to achieve from their portfolio and $\ones$ column vector of ones with appropriate dimensions. \citet{markowitz1959portfolio} considered the following optimization problem
\begin{equation}\label{eqn:markowitz_optim}
\begin{aligned}
& \underset{\bw}{\text{minimize}} 
& & \bw^\top \bSigma \bw \\
& \text{subject to}
& & \bw^\top \ones = 1 \\
& && \bw^\top \bmu \geq \mu_0 \\
&&& w_i \geq 0, i=1,2,..,p
\end{aligned}
\end{equation}
This problem is a quadratic optimization problem with linear equality and inequality constraints. 
The objective is to minimize the variance of the portfolio. 
A natural question is to ask whether or not that implies diversification? As it turns out, minimizing the portfolio variance will encourage diversification.
\textbf{Give example on using convex combinations on variances.} 
 
The constraint $\bw^\top \ones = 1$ essentially states that the investor must invest all available money. 
The weights are scaled according to the amount of cash invested.
The disposition is very different whenever an inequality is used rather than equality. 
As \citet{hult2012risk} states, if $\bw^\top \ones \leq 1$, then the investor could be throwing money away since there is a lot of opportunity left in the market when investing.
The second constraint describes the investors expectations on the portfolio. 
As $\mu_0$ grows, the return of the portfolio will grow. 
However, that has implications for the objective. 
Increasing $\mu_0$ will change the amount of variance the portfolio can achieve. 
\textbf{insert figure for quadratic optimization problem and the different hyperplanes in two dimensions.}

From Figure ... all values of $\mu_0$ are feasible though they may/will come at a cost. 
Depending on the value $\mu_0$ we would be accepting more risk. 
The last constraint is rather simple though have quite large implications. 
It states that the weights can not be negative which means that we can only invest money we have. 
A negative value of $w_i$ in the $i$th asset is called a short position.
You borrow the asset from someone who owns it and then sell it. 
Later on, you can buy it back, hoping that the price is less so that you can make money on such a position. 
For certain types of investors this constraint can be limiting.
We can sometimes obtain less risk if we exclude it, which is the case of all papers in this thesis. That is, this thesis considers
\begin{equation}\label{eqn:mean_variance}
\begin{aligned}
& \underset{\bw}{\text{minimize}} 
& & \bw^\top \bSigma \bw \\
& \text{subject to}
& & \bw^\top \ones = 1 \\
& && \bw^\top \bmu \geq \mu_0 \\
\end{aligned}
\end{equation}
which is what we refer to the mean-variance optimization problem. 
The problem can be solved by langrange multipliers and its solution will always result in \textit{active} constraints, e.g. $\bw^\top \bmu = \mu_0$. 
For the interested reader we suggest \citet{} on why that is, we merely take it for granted in this introduction. 
The solution to this problem is very often stated relative to another famous portfolio, namely the Global Minimum Variance (GMV) portfolio and its related quantities (see e.g. \citet{Bodnar2009CaIotEFiEM, bodnar2013equivalence, bauder2018bayesian}). We will continue in the same manner. Let $\bSigma^{-1}$ denote the inverse of $\bSigma$ and 
\begin{equation}
	\bw_{GMV} = \frac{\bSigma^{-1}\ones}{\ones^\top \bSigma^{-1}\ones}, \; R_{GMV} =\optn{E}(\bw_{GMV}^\top\bx) = \frac{\ones^\top\bSigma^{-1}\bmu}{\ones^\top \bSigma^{-1}\ones}, \;
	V_{GMV} = \optn{Var}(\bw_{GMV}^\top\bx) =\frac{1}{\ones^\top \bSigma^{-1}\ones}.
\end{equation}
 \textbf{explain the quantities.}
  
The solution to the mean-variance problem in \eqref{eqn:mean_variance} is equal to
\begin{equation}\label{eqn:mean_var_solution}
	\bw_{MV} = \frac{\bSigma^{-1}\ones}{\ones^\top \bSigma^{-1}\ones} + \frac{\mu_0 - R_{GMV}}{V_{GMV}} \bQ \bmu,\; \bQ = \bSigma^{-1} - \frac{\bSigma^{-1} \ones \ones^\top \bSigma^{-1}}{\ones^\top \bSigma^{-1} \ones}
\end{equation}
Setting $\mu_0$ equal to $\bmu^\top \bSigma^{-1} \ones / \ones^\top \bSigma^{-1} \ones$ results in the GMV portfolio. Excluding the constraint all together results in the same solution. If $\bmu_0>R_{GMV}$ then it is easy to see that this portfolio has the smallest amount of variance of all solutions to \eqref{eqn:mean_variance}, it will give the least amount of risk. Using
\textbf{Introduce merton and the efficient frontier.}

%%% ----------------------
\section{The Covariance and Precision matrix}
%%% ----------------------
The covariance matrix $\bSigma$ and the precision matrix $\bSigma^{-1}$ are fundemental to mean-variance portfolios. In this section we discuss the restrictions we place on the covariance matrix and what the inverse of that matrix actually represent. 

For a vector $\bx$ with finite second moment, the covariance matrix is defined as $\bSigma=\optn{E}((\bx - \bmu)(\bx - \bmu)^\top)$. 
It contains the variances of each individual element of $\bx$ on the diagonal as well as the covariance between every pair of elements on the off-diagonal. 
That is, each diagonal element corresponds to the univariate case where the variance is equal to $\optn{E}((x_i - \mu_i)^2)$. 
A distribution is called degenerate or singular if the variance is equal to zero, which holds true in the multivariate context as well. 
If any diagonal element is zero, then the covariance matrix is called singular.  

However, due to the fact that we involve covariances on the off-diagonal we are forced to include a broader definition.  
Since we work with real matrices in this thesis, we limit the definition accordingly.
\begin{definition}[Page 4, \citet{gupta2013elliptically}]
	A real symmetric matrix $\bA$ is called 
	\begin{itemize}
		\item positive definite if $\bz^\top \bA \bz > 0$
		\item positive semi-definite if $\bz^\top \bA \bz \geq 0$
	\end{itemize}
	for all nonzero vectors $\bz \in \mathbbm{R}^p$.
\end{definition} 
In the multivariate case the 


From Markowitz optimization problem \eqref{eqn:markowitz_optim} we stated its solution \eqref{eqn:mean_var_solution}. 
\begin{itemize}
	\item Description and introduction to the covariance matrix, positive semidefinite, positive definite .
	\item The precision matrix - Regular inverse, what does it represent and mean? Eigenvalues!
\end{itemize}
% Connect to the papers!


% Connect to the papers!

%%%%%% ------------------------------------------------------------------------
\chapter{Statistical models and estimation}
%%%%%% ------------------------------------------------------------------------
\begin{itemize}
	\item Multivariate Normal
	\item Wishart distribution and properties
% 	\item Elliptical distributions
	\item Matrix variate location and scale. 
\end{itemize}

As statisticians we are 
\section{Estimation - the name of the game}

\begin{itemize}
	\item What are the implications of using $\bS$ instead of $\bSigma$?
	\item why is $\bS$  always an admissible estimator? (MM)
	\item Other types of estimators and why they might be better than $\bS$.
\end{itemize}

\begin{remark}
	Unconditional and conditional covariance estimation. Prediction is very hard and constructing viable models. Are returns predictable? Should we even try?
\end{remark}

\section{Simulations, inverses and why stochastic representations are valuable}
\begin{itemize}
	\item Motivating simulations and the issue with inversions.
	\item Simulation of multi- or matrixvariate distributions can be very computationally consuming. Take Paper 2, where we can try to make robustness tests. Give an example of simulating from the $CSN_{p,n,1,1}$ distribution with $d\neq 1,1,1,...,1$. We need to allocate a vector which is quite long. Is it always possible to allocate such a vector?
	\item ...
\end{itemize}
%%%%%% ------------------------------------------------------------------------
\chapter{Many assets and higher dimensions}
%%%%%% ------------------------------------------------------------------------
\section{Random Matrix Theory and eigenvalues}

\section{The implications of large dimensions for portfolio theory}

%%%%%% ------------------------------------------------------------------------
\chapter{Summary of Papers}
%%%%%% ------------------------------------------------------------------------
The papers presented here are among a total of ... papers produced. These are selected based their common theme.
\section*{Paper 1}
Sampling dist.
\section*{Paper 2}
TP portfolio CSN model.


From Chapter \ref{ch:intro} we constructed an example with the possibility of lending money. That is usually referred to as a risk-free rate or asset, commonly denoted denoted $r_f$. It can be a bond or the interest rate on a loan. However, from \eqref{eqn:markowitz_optim} there is no risk-free rate. To introduce this option into our portfolio we simply add the risk-free rate as $w_0 r_f + \bw^\top \bx$ and optimize over $w_0$ as well. However, since $w_0 r_f + \bw^\top \bw=1$ we can simply rescale 
\textbf{Introduce a figure of the efficient frontier with the riskfree rate}
\section*{Paper 3}
Dynamic shrinkage.

This setting might motivate the use of conditional covariance matrices. However, whenever asymptotics/limits are taken in a unconditional (or conditional) setting, we will always update our estimate. An update in the estimate of the mean or covariance matrix will cause an update in the weights of our portfolios. 
\section*{Paper 4}
Double shrinkage?
%\section{Paper 5}
% Backtesting in higher dimensions, many VaR predictions and many
%%%%%% ------------------------------------------------------------------------
\chapter{Future research}
%%%%%% ------------------------------------------------------------------------
There are many possible extensions to the theory at hand. 

\begin{itemize}
	\item The ongoing issue of the elliptical distribution and its inverse sample dispersion matrix. What are the moments of $(\mathbf{Z} \mathbf{R} \mathbf{Z}^\top)^{-1}$?
	\item In reality, when taking large samples and higher dimensions we work with one bootstrapped sample of them, i.e. $\mathbf{M} \mathbf{Y}$ where $\mathbf{M}$ is $k \times p$ where $k<p$. What happens when $p \rightarrow \infty$ but $k$ stays finite? What are the implications of the bootstrapping? 
	\item There are different ways of incorporating estimation uncertainty, one solution is robust optimization. Is robust optimization just Emperical Bayes?
	\item Sequential reweighting extension to Paper 3. When should we reweight?
	\item Stochastic representations and markov chains. Simple to sample from stochastic representations, are there ways to boost performance of MCMC methods?
\end{itemize}

Although not part of this Phd thesis Flipped classroom and online learning tools.

\bibliography{references}
\end{document}
